DROP TABLE IF EXISTS USERS CASCADE;
DROP TABLE IF EXISTS CATEGORIES CASCADE;
DROP TABLE IF EXISTS EVENTS CASCADE;
DROP TABLE IF EXISTS LOCATION CASCADE;

CREATE TABLE IF NOT EXISTS USERS
(
    USER_ID   BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    USER_NAME VARCHAR(255) UNIQUE                     NOT NULL,
    EMAIL     VARCHAR(512) UNIQUE                     NOT NULL,
    CONSTRAINT PK_USER PRIMARY KEY (USER_ID)
);

CREATE TABLE IF NOT EXISTS CATEGORIES
(
    CATEGORY_ID   BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    CATEGORY_NAME VARCHAR(100) UNIQUE                     NOT NULL,
    CONSTRAINT PK_CATEGORY PRIMARY KEY (CATEGORY_ID)
);

CREATE TABLE IF NOT EXISTS LOCATION
(
    LOCATION_ID BIGINT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    LAT         FLOAT,
    LON         FLOAT
);

CREATE TABLE IF NOT EXISTS EVENTS
(
    EVENT_ID                 BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    EVENT_TITLE              VARCHAR(300),
    EVENT_ANNOTATION         VARCHAR(500)                            NOT NULL,
    EVENT_DESCRIPTION        VARCHAR(4000)                           NOT NULL,
    EVENT_INITIATOR          BIGINT                                  NOT NULL,
    EVENT_CREATED            TIMESTAMP WITHOUT TIME ZONE,
    EVENT_CATEGORY           BIGINT                                  NOT NULL,
    EVENT_DATE               TIMESTAMP WITHOUT TIME ZONE,
    EVENT_PAID               BOOLEAN,
    EVENT_PUBLISHED_ON       TIMESTAMP WITHOUT TIME ZONE,
    EVENT_PARTICIPANT_LIMIT  BIGINT,
    EVENT_REQUEST_MODERATION BOOLEAN,
    EVENT_CONFIRMED_REQUESTS BIGINT,
    EVENT_STATE              VARCHAR(20),
    EVENT_VIEWS              BIGINT,
    EVENT_LOCATION           BIGINT,

    CONSTRAINT PK_EVENTS PRIMARY KEY (EVENT_ID),
    CONSTRAINT EVENTS_CATEGORY FOREIGN KEY (EVENT_CATEGORY) REFERENCES CATEGORIES (CATEGORY_ID),
    CONSTRAINT EVENT_INITIATOR FOREIGN KEY (EVENT_INITIATOR) REFERENCES USERS (USER_ID),
    CONSTRAINT EVENT_LOCATION FOREIGN KEY (EVENT_LOCATION) REFERENCES LOCATION (LOCATION_ID)

);

