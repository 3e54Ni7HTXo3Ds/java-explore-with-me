DROP TABLE IF EXISTS USERS CASCADE;
DROP TABLE IF EXISTS CATEGORIES CASCADE;
DROP TABLE IF EXISTS EVENTS CASCADE;

CREATE TABLE IF NOT EXISTS USERS
(
    USER_ID   BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    USER_NAME VARCHAR(255)                            NOT NULL,
    EMAIL     VARCHAR(512)                            NOT NULL,
    CONSTRAINT PK_USER PRIMARY KEY (USER_ID),
    CONSTRAINT UQ_USER_EMAIL UNIQUE (EMAIL),
    CONSTRAINT UQ_USER_NAME UNIQUE (USER_NAME)
);

CREATE TABLE IF NOT EXISTS CATEGORIES
(
    CATEGORY_ID   BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    CATEGORY_NAME VARCHAR UNIQUE                          NOT NULL,
    CONSTRAINT PK_CATEGORY PRIMARY KEY (CATEGORY_ID)
);

CREATE TABLE IF NOT EXISTS EVENTS
(
    EVENT_ID                 BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    EVENT_TITLE              VARCHAR(300),
    EVENT_ANNOTATION         VARCHAR(500)                            NOT NULL,
    EVENT_DESCRIPTION        VARCHAR(4000)                           NOT NULL,
    EVENT_INITIATOR          BIGINT                                  NOT NULL,
    EVENT_CREATED            TIMESTAMP WITHOUT TIME ZONE,
    EVENT_CATEGORY           BIGINT                                  NOT NULL,
    EVENT_DATE               TIMESTAMP WITHOUT TIME ZONE,
    EVENT_PAID               BOOLEAN,
    EVENT_PUBLISHED_ON       TIMESTAMP WITHOUT TIME ZONE,
    EVENT_PARTICIPANT_LIMIT  BIGINT,
    EVENT_REQUEST_MODERATION BOOLEAN,
    EVENT_CONFIRMED_REQUESTS BIGINT,
    EVENT_STATE              VARCHAR,
    EVENT_VIEWS              BIGINT,

    CONSTRAINT PK_EVENTS PRIMARY KEY (EVENT_ID),
    CONSTRAINT EVENTS_CATEGORY FOREIGN KEY (EVENT_CATEGORY) REFERENCES CATEGORIES (CATEGORY_ID),
    CONSTRAINT EVENT_INITIATOR FOREIGN KEY (EVENT_INITIATOR) REFERENCES USERS (USER_ID)

);